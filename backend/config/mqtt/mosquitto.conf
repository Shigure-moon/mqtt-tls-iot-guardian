# Mosquitto MQTT Broker 配置

# 监听端口（不使用TLS，用于开发）
listener 1883 0.0.0.0
protocol mqtt

# TLS监听端口
listener 8883 0.0.0.0
protocol mqtt
cafile /mosquitto/config/certs/ca.crt
certfile /mosquitto/config/certs/server.crt
keyfile /mosquitto/config/certs/server.key
require_certificate false  # 设为true启用双向认证
allow_anonymous true

# WebSocket 监听端口（用于前端实时通信）
listener 9001 0.0.0.0
protocol websockets

# 如果有TLS证书文件，可以启用TLS WebSocket
# listener 9443 0.0.0.0
# protocol websockets
# cafile /mosquitto/config/certs/ca.crt
# certfile /mosquitto/config/certs/server.crt
# keyfile /mosquitto/config/certs/server.key
# require_certificate false

# 允许匿名连接（开发环境，生产环境应关闭）
allow_anonymous true

# 日志配置
log_dest file /mosquitto/log/mosquitto.log
log_type all
log_timestamp true

# 持久化
persistence true
persistence_location /mosquitto/data/

# 连接消息
connection_messages true

# 最大连接数（-1表示无限制）
max_connections -1

# 消息大小限制（字节）
max_packet_size 268435455
